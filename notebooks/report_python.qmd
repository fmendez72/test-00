---
title: "VAA Synthetic Data — Exploratory Report"
subtitle: "Python version"
author: "Fernando Mendez"
date: today
format:
  html:
    toc: true
    toc-depth: 2
    code-fold: true
    theme: cosmo
    self-contained: true
jupyter: test-00
---

## Overview

This report explores the synthetic VAA dataset generated by `src/generate_data.py`.
The dataset contains **500 simulated respondents** with positions on **10 policy issues**,
matched to 6 parties using a proximity voting model.

```{python}
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.ticker as mticker
import numpy as np
from pathlib import Path

data_dir = Path("../data")
respondents = pd.read_csv(data_dir / "vaa_respondents.csv")
party_pos = pd.read_csv(data_dir / "vaa_party_positions.csv")

print(f"Respondents: {respondents.shape}")
respondents.head()
```

## Vote Share

```{python}
vote_share = (
    respondents["vote_choice"]
    .value_counts(normalize=True)
    .mul(100)
    .reset_index()
)
vote_share.columns = ["party", "share"]

fig, ax = plt.subplots(figsize=(7, 4))
bars = ax.barh(vote_share["party"], vote_share["share"], color="steelblue")
ax.bar_label(bars, fmt="%.1f%%", padding=4)
ax.set_xlabel("Vote share (%)")
ax.set_title("Simulated Vote Share by Party")
ax.invert_yaxis()
plt.tight_layout()
plt.show()
```

## Respondent Demographics

```{python}
fig, axes = plt.subplots(1, 3, figsize=(12, 4))

# Age distribution
axes[0].hist(respondents["age"], bins=20, color="steelblue", edgecolor="white")
axes[0].set_title("Age Distribution")
axes[0].set_xlabel("Age")

# Gender
gender_counts = respondents["gender"].value_counts()
axes[1].pie(gender_counts, labels=gender_counts.index, autopct="%1.1f%%", startangle=90)
axes[1].set_title("Gender")

# Education
edu_order = ["primary", "secondary", "tertiary"]
edu_counts = respondents["education"].value_counts().reindex(edu_order)
axes[2].bar(edu_counts.index, edu_counts.values, color="steelblue", edgecolor="white")
axes[2].set_title("Education Level")

plt.tight_layout()
plt.show()
```

## Party Positions on Policy Issues

```{python}
pivot = party_pos.pivot(index="party", columns="issue", values="position")

fig, ax = plt.subplots(figsize=(12, 5))
im = ax.imshow(pivot.values, cmap="RdBu", vmin=-2, vmax=2, aspect="auto")
ax.set_xticks(range(len(pivot.columns)))
ax.set_xticklabels(pivot.columns, rotation=45, ha="right")
ax.set_yticks(range(len(pivot.index)))
ax.set_yticklabels(pivot.index)
plt.colorbar(im, ax=ax, label="Position (−2 = against, +2 = for)")
ax.set_title("Party Positions by Issue")
plt.tight_layout()
plt.show()
```

## Mean Respondent Positions by Vote Choice

```{python}
issues = [c for c in respondents.columns if c not in ("respondent_id", "age", "gender", "education", "vote_choice")]

mean_pos = respondents.groupby("vote_choice")[issues].mean()

fig, ax = plt.subplots(figsize=(12, 5))
im = ax.imshow(mean_pos.values, cmap="RdBu", vmin=-2, vmax=2, aspect="auto")
ax.set_xticks(range(len(issues)))
ax.set_xticklabels(issues, rotation=45, ha="right")
ax.set_yticks(range(len(mean_pos.index)))
ax.set_yticklabels(mean_pos.index)
plt.colorbar(im, ax=ax, label="Mean position")
ax.set_title("Mean Respondent Positions by Vote Choice")
plt.tight_layout()
plt.show()
```
